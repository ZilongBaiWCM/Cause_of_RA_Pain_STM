---
title: "ligand-receptor interactomes mouse DRG final code"
author: "Nick Bartelo"
date: "2024-03-02"
output: html_document
editor_options: 
  chunk_output_type: console
---

First we import the packages we may use.

```{r, warning=FALSE, message = FALSE}
library(BioCircos)
```

Below we import the data.

```{r}
# Ligand-coding genes from mDRG bulk RNA-sequencing results
mdrg_to_ra_specific_neurons <- read.csv('mouseDRG_ligands_to_RA_pain_receptors_interaction_interactome_all_v2_bw_specific_neurons.csv', row.names = 1)
mdrg_to_ra_all_types <- read.csv('mouseDRG_ligands_to_RA_pain_receptors_interaction_interactome_all_v2_neurons_vs_all_others_v2.csv', row.names = 1)
mdrg_to_ra_all_neurons <- read.csv('mouseDRG_ligands_to_RA_pain_receptors_interaction_interactome_all_v2_neurons_vs_other_neurons.csv', row.names = 1)

# Ligand-coding genes from the RA single-cell RNA-sequencing results
ra_to_mdrg_specific_neurons <- read.csv('RA_pain_ligands_to_mouseDRG_receptors_interaction_interactome_all_v2_bw_specific_neurons.csv', row.names = 1)
ra_to_mdrg_all_types <- read.csv('RA_pain_ligands_to_mouseDRG_receptors_interaction_interactome_all_v2_neurons_vs_all_others_v2.csv', row.names = 1)
ra_to_mdrg_all_neurons <- read.csv('RA_pain_ligands_to_mouseDRG_receptors_interaction_interactome_all_v2_neurons_vs_other_neurons.csv', row.names = 1)
```

Below we add a variable to each dataframe in order to identify if the genes are from the mDRG or RA single-cell results.

```{r}
mdrg_to_ra_specific_neurons$location <- 'mDRG'
ra_to_mdrg_specific_neurons$location <- 'RA sc'
mdrg_to_ra_all_types$location <- 'mDRG'
ra_to_mdrg_all_types$location <- 'RA sc'
mdrg_to_ra_all_neurons$location <- 'mDRG'
ra_to_mdrg_all_neurons$location <- 'RA sc'
```

Below we combine the data.

```{r}
specific_neuron_data <- rbind(mdrg_to_ra_specific_neurons, ra_to_mdrg_specific_neurons)
all_types_data <- rbind(mdrg_to_ra_all_types, ra_to_mdrg_all_types)
all_neurons_data <- rbind(mdrg_to_ra_all_neurons, ra_to_mdrg_all_neurons)
```

Below we show the number of unique genes in each file for the ligands and the receptors.

```{r}
length(unique(specific_neuron_data$ligand))
length(unique(all_types_data$ligand))
length(unique(all_neurons_data$ligand))

length(unique(specific_neuron_data$receptor))
length(unique(all_types_data$receptor))
length(unique(all_neurons_data$receptor))
```

Below we split each dataframe by fibroblast subtype.

```{r}
print('-----------------For specific neuron data file:--------------')
specific_neuron_data_f1 <- specific_neuron_data[(specific_neuron_data$ligand_type == 'SC-F1') | (specific_neuron_data$receptor_type == 'SC-F1'),]
print(nrow(specific_neuron_data_f1))
specific_neuron_data_f2 <- specific_neuron_data[(specific_neuron_data$ligand_type == 'SC-F2') | (specific_neuron_data$receptor_type == 'SC-F2'),]
print(nrow(specific_neuron_data_f2))
specific_neuron_data_f3 <- specific_neuron_data[(specific_neuron_data$ligand_type == 'SC-F3') | (specific_neuron_data$receptor_type == 'SC-F3'),]
print(nrow(specific_neuron_data_f3))
specific_neuron_data_f4 <- specific_neuron_data[(specific_neuron_data$ligand_type == 'SC-F4') | (specific_neuron_data$receptor_type == 'SC-F4'),]
print(nrow(specific_neuron_data_f4))

print('-----------------For all types data file:--------------')

all_types_data_f1 <- all_types_data[(all_types_data$ligand_type == 'SC-F1') | (all_types_data$receptor_type == 'SC-F1'),]
print(nrow(all_types_data_f1))
all_types_data_f2 <- all_types_data[(all_types_data$ligand_type == 'SC-F2') | (all_types_data$receptor_type == 'SC-F2'),]
print(nrow(all_types_data_f2))
all_types_data_f3 <- all_types_data[(all_types_data$ligand_type == 'SC-F3') | (all_types_data$receptor_type == 'SC-F3'),]
print(nrow(all_types_data_f3))
all_types_data_f4 <- all_types_data[(all_types_data$ligand_type == 'SC-F4') | (all_types_data$receptor_type == 'SC-F4'),]
print(nrow(all_types_data_f4))

print('-----------------For all neurons data file:--------------')
all_neuron_data_f1 <- all_neurons_data[(all_neurons_data$ligand_type == 'SC-F1') | (all_neurons_data$receptor_type == 'SC-F1'),]
print(nrow(all_neuron_data_f1))
all_neuron_data_f2 <- all_neurons_data[(all_neurons_data$ligand_type == 'SC-F2') | (all_neurons_data$receptor_type == 'SC-F2'),]
print(nrow(all_neuron_data_f2))
all_neuron_data_f3 <- all_neurons_data[(all_neurons_data$ligand_type == 'SC-F3') | (all_neurons_data$receptor_type == 'SC-F3'),]
print(nrow(all_neuron_data_f3))
all_neuron_data_f4 <- all_neurons_data[(all_neurons_data$ligand_type == 'SC-F4') | (all_neurons_data$receptor_type == 'SC-F4'),]
print(nrow(all_neuron_data_f4))
```

Below we get statistics for a multitude of things for specific neurons.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------SC-F1------------------')
length(unique(specific_neuron_data_f1$ligand))
length(unique(specific_neuron_data_f1$receptor))
specific_neuron_data_f1_mdrg = specific_neuron_data_f1[specific_neuron_data_f1$location == 'mDRG',]
nrow(specific_neuron_data_f1_mdrg)
length(unique(specific_neuron_data_f1_mdrg$ligand))
length(unique(specific_neuron_data_f1_mdrg$receptor))
specific_neuron_data_f1_ra = specific_neuron_data_f1[specific_neuron_data_f1$location == 'RA sc',]
nrow(specific_neuron_data_f1_ra)
length(unique(specific_neuron_data_f1_ra$ligand))
length(unique(specific_neuron_data_f1_ra$receptor))

print('-------------SC-F2------------------')
length(unique(specific_neuron_data_f2$ligand))
length(unique(specific_neuron_data_f2$receptor))
specific_neuron_data_f2_mdrg = specific_neuron_data_f2[specific_neuron_data_f2$location == 'mDRG',]
nrow(specific_neuron_data_f2_mdrg)
length(unique(specific_neuron_data_f2_mdrg$ligand))
length(unique(specific_neuron_data_f2_mdrg$receptor))
specific_neuron_data_f2_ra = specific_neuron_data_f2[specific_neuron_data_f2$location == 'RA sc',]
nrow(specific_neuron_data_f2_ra)
length(unique(specific_neuron_data_f2_ra$ligand))
length(unique(specific_neuron_data_f2_ra$receptor))

print('-------------SC-F3------------------')
length(unique(specific_neuron_data_f3$ligand))
length(unique(specific_neuron_data_f3$receptor))
specific_neuron_data_f3_mdrg = specific_neuron_data_f3[specific_neuron_data_f3$location == 'mDRG',]
nrow(specific_neuron_data_f3_mdrg)
length(unique(specific_neuron_data_f3_mdrg$ligand))
length(unique(specific_neuron_data_f3_mdrg$receptor))
specific_neuron_data_f3_ra = specific_neuron_data_f3[specific_neuron_data_f3$location == 'RA sc',]
nrow(specific_neuron_data_f3_ra)
length(unique(specific_neuron_data_f3_ra$ligand))
length(unique(specific_neuron_data_f3_ra$receptor))

print('-------------SC-F4------------------')
length(unique(specific_neuron_data_f4$ligand))
length(unique(specific_neuron_data_f4$receptor))
specific_neuron_data_f4_mdrg = specific_neuron_data_f4[specific_neuron_data_f4$location == 'mDRG',]
nrow(specific_neuron_data_f4_mdrg)
length(unique(specific_neuron_data_f4_mdrg$ligand))
length(unique(specific_neuron_data_f4_mdrg$receptor))
specific_neuron_data_f4_ra = specific_neuron_data_f4[specific_neuron_data_f4$location == 'RA sc',]
nrow(specific_neuron_data_f4_ra)
length(unique(specific_neuron_data_f4_ra$ligand))
length(unique(specific_neuron_data_f4_ra$receptor))
```

Below we get statistics for a multitude of things for all types.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------SC-F1------------------')
length(unique(all_types_data_f1$ligand))
length(unique(all_types_data_f1$receptor))
all_types_data_f1_mdrg = all_types_data_f1[all_types_data_f1$location == 'mDRG',]
nrow(all_types_data_f1_mdrg)
length(unique(all_types_data_f1_mdrg$ligand))
length(unique(all_types_data_f1_mdrg$receptor))
all_types_data_f1_ra = all_types_data_f1[all_types_data_f1$location == 'RA sc',]
nrow(all_types_data_f1_ra)
length(unique(all_types_data_f1_ra$ligand))
length(unique(all_types_data_f1_ra$receptor))

print('-------------SC-F2------------------')
length(unique(all_types_data_f2$ligand))
length(unique(all_types_data_f2$receptor))
all_types_data_f2_mdrg = all_types_data_f2[all_types_data_f2$location == 'mDRG',]
nrow(all_types_data_f2_mdrg)
length(unique(all_types_data_f2_mdrg$ligand))
length(unique(all_types_data_f2_mdrg$receptor))
all_types_data_f2_ra = all_types_data_f2[all_types_data_f2$location == 'RA sc',]
nrow(all_types_data_f2_ra)
length(unique(all_types_data_f2_ra$ligand))
length(unique(all_types_data_f2_ra$receptor))

print('-------------SC-F3------------------')
length(unique(all_types_data_f3$ligand))
length(unique(all_types_data_f3$receptor))
all_types_data_f3_mdrg = all_types_data_f3[all_types_data_f3$location == 'mDRG',]
nrow(all_types_data_f3_mdrg)
length(unique(all_types_data_f3_mdrg$ligand))
length(unique(all_types_data_f3_mdrg$receptor))
all_types_data_f3_ra = all_types_data_f3[all_types_data_f3$location == 'RA sc',]
nrow(all_types_data_f3_ra)
length(unique(all_types_data_f3_ra$ligand))
length(unique(all_types_data_f3_ra$receptor))

print('-------------SC-F4------------------')
length(unique(all_types_data_f4$ligand))
length(unique(all_types_data_f4$receptor))
all_types_data_f4_mdrg = all_types_data_f4[all_types_data_f4$location == 'mDRG',]
nrow(all_types_data_f4_mdrg)
length(unique(all_types_data_f4_mdrg$ligand))
length(unique(all_types_data_f4_mdrg$receptor))
all_types_data_f4_ra = all_types_data_f4[all_types_data_f4$location == 'RA sc',]
nrow(all_types_data_f4_ra)
length(unique(all_types_data_f4_ra$ligand))
length(unique(all_types_data_f4_ra$receptor))
```

Below we get statistics for a multitude of things for all neurons.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------SC-F1------------------')
length(unique(all_neuron_data_f1$ligand))
length(unique(all_neuron_data_f1$receptor))
all_neuron_data_f1_mdrg = all_neuron_data_f1[all_neuron_data_f1$location == 'mDRG',]
nrow(all_neuron_data_f1_mdrg)
length(unique(all_neuron_data_f1_mdrg$ligand))
length(unique(all_neuron_data_f1_mdrg$receptor))
all_neuron_data_f1_ra = all_neuron_data_f1[all_neuron_data_f1$location == 'RA sc',]
nrow(all_neuron_data_f1_ra)
length(unique(all_neuron_data_f1_ra$ligand))
length(unique(all_neuron_data_f1_ra$receptor))

print('-------------SC-F2------------------')
length(unique(all_neuron_data_f2$ligand))
length(unique(all_neuron_data_f2$receptor))
all_neuron_data_f2_mdrg = all_neuron_data_f2[all_neuron_data_f2$location == 'mDRG',]
nrow(all_neuron_data_f2_mdrg)
length(unique(all_neuron_data_f2_mdrg$ligand))
length(unique(all_neuron_data_f2_mdrg$receptor))
all_neuron_data_f2_ra = all_neuron_data_f2[all_neuron_data_f2$location == 'RA sc',]
nrow(all_neuron_data_f2_ra)
length(unique(all_neuron_data_f2_ra$ligand))
length(unique(all_neuron_data_f2_ra$receptor))

print('-------------SC-F3------------------')
length(unique(all_neuron_data_f3$ligand))
length(unique(all_neuron_data_f3$receptor))
all_neuron_data_f3_mdrg = all_neuron_data_f3[all_neuron_data_f3$location == 'mDRG',]
nrow(all_neuron_data_f3_mdrg)
length(unique(all_neuron_data_f3_mdrg$ligand))
length(unique(all_neuron_data_f3_mdrg$receptor))
all_neuron_data_f3_ra = all_neuron_data_f3[all_neuron_data_f3$location == 'RA sc',]
nrow(all_neuron_data_f3_ra)
length(unique(all_neuron_data_f3_ra$ligand))
length(unique(all_neuron_data_f3_ra$receptor))

print('-------------SC-F4------------------')
length(unique(all_neuron_data_f4$ligand))
length(unique(all_neuron_data_f4$receptor))
all_neuron_data_f4_mdrg = all_neuron_data_f4[all_neuron_data_f4$location == 'mDRG',]
nrow(all_neuron_data_f4_mdrg)
length(unique(all_neuron_data_f4_mdrg$ligand))
length(unique(all_neuron_data_f4_mdrg$receptor))
all_neuron_data_f4_ra = all_neuron_data_f4[all_neuron_data_f4$location == 'RA sc',]
nrow(all_neuron_data_f4_ra)
length(unique(all_neuron_data_f4_ra$ligand))
length(unique(all_neuron_data_f4_ra$receptor))
```

Below we specify by the three specific neuron cell types for all types before splitting by fibroblast subtype.

```{r}
print('------------Peripheral sensory neurofilament neurons--------------')
all_neurons_data_peripheral_sensory_neurofilament_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory neurofilament neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory neurofilament neurons'),]

print('------------Peripheral sensory non-peptidergic neurons--------------')
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]

print('------------Peripheral sensory peptidergic neurons--------------')
all_neurons_data_peripheral_sensory_peptidergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory peptidergic neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory peptidergic neurons'),]

print('------------Cerebellum neurons--------------')
all_neurons_data_cerebellum_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Cerebellum neurons') | (all_neurons_data$receptor_type == 'Cerebellum neurons'),]

print('------------Cholinergic and monoaminergic neurons--------------')
all_neurons_data_cholinergic_and_monoaminergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Cholinergic and monoaminergic neurons') | (all_neurons_data$receptor_type == 'Cholinergic and monoaminergic neurons'),]

print('------------Dentate gyrus granule neurons--------------')
all_neurons_data_dentate_gyrus_granule_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Dentate gyrus granule neurons') | (all_neurons_data$receptor_type == 'Dentate gyrus granule neurons'),]

print('------------Di- and mesencephalon excitatory neurons--------------')
all_neurons_data_di_and_mesencephalon_excitatory_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Di- and mesencephalon excitatory neurons') | (all_neurons_data$receptor_type == 'Di- and mesencephalon excitatory neurons'),]

print('------------Di- and mesencephalon inhibitory neurons--------------')
all_neurons_data_di_and_mesencephalon_inhibitory_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Di- and mesencephalon inhibitory neurons') | (all_neurons_data$receptor_type == 'Di- and mesencephalon inhibitory neurons'),]

print('------------Enteric neurons--------------')
all_neurons_data_enteric_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Enteric neurons') | (all_neurons_data$receptor_type == 'Enteric neurons'),]

print('------------Hindbrain neurons--------------')
all_neurons_data_hindbrain_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Hindbrain neurons') | (all_neurons_data$receptor_type == 'Hindbrain neurons'),]

print('------------Olfactory inhibitory neurons--------------')
all_neurons_data_olfactory_inhibitory_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Olfactory inhibitory neurons') | (all_neurons_data$receptor_type == 'Olfactory inhibitory neurons'),]

print('------------Peptidergic neurons--------------')
all_neurons_data_peptidergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peptidergic neurons') | (all_neurons_data$receptor_type == 'Peptidergic neurons'),]

print('------------Spinal cord inhibitory neurons--------------')
all_neurons_data_spinal_cord_inhibitory_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Spinal cord inhibitory neurons') | (all_neurons_data$receptor_type == 'Spinal cord inhibitory neurons'),]

print('------------Spinal cord excitatory neurons--------------')
all_neurons_data_spinal_cord_excitatory_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Spinal cord excitatory neurons') | (all_neurons_data$receptor_type == 'Spinal cord excitatory neurons'),]

print('------------Sympathetic cholinergic neurons--------------')
all_neurons_data_sympathetic_cholinergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Sympathetic cholinergic neurons') | (all_neurons_data$receptor_type == 'Sympathetic cholinergic neurons'),]

print('------------Sympathetic noradrenergic neurons--------------')
all_neurons_data_sympathetic_nonadrenergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Sympathetic noradrenergic neurons') | (all_neurons_data$receptor_type == 'Sympathetic noradrenergic neurons'),]
```

Below we look at some statistics for the unique cell types.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')

print('------------Cerebellum neurons--------------')
length(unique(all_neurons_data_cerebellum_neurons$ligand))
length(unique(all_neurons_data_cerebellum_neurons$receptor))
all_neurons_data_cerebellum_neurons_mdrg = all_neurons_data_cerebellum_neurons[all_neurons_data_cerebellum_neurons$location == 'mDRG',]
nrow(all_neurons_data_cerebellum_neurons_mdrg)
length(unique(all_neurons_data_cerebellum_neurons_mdrg$ligand))
length(unique(all_neurons_data_cerebellum_neurons_mdrg$receptor))
all_neurons_data_cerebellum_neurons_ra = all_neurons_data_cerebellum_neurons[all_neurons_data_cerebellum_neurons$location == 'RA sc',]
nrow(all_neurons_data_cerebellum_neurons_ra)
length(unique(all_neurons_data_cerebellum_neurons_ra$ligand))
length(unique(all_neurons_data_cerebellum_neurons_ra$receptor))
print('------------Cholinergic and monoaminergic neurons--------------')
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons$ligand))
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons$receptor))
all_neurons_data_cholinergic_and_monoaminergic_neurons_mdrg = all_neurons_data_cholinergic_and_monoaminergic_neurons[all_neurons_data_cholinergic_and_monoaminergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_cholinergic_and_monoaminergic_neurons_mdrg)
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons_mdrg$receptor))
all_neurons_data_cholinergic_and_monoaminergic_neurons_ra = all_neurons_data_cholinergic_and_monoaminergic_neurons[all_neurons_data_cholinergic_and_monoaminergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_cholinergic_and_monoaminergic_neurons_ra)
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons_ra$ligand))
length(unique(all_neurons_data_cholinergic_and_monoaminergic_neurons_ra$receptor))
print('------------Dentate gyrus granule neurons--------------')
length(unique(all_neurons_data_dentate_gyrus_granule_neurons$ligand))
length(unique(all_neurons_data_dentate_gyrus_granule_neurons$receptor))
all_neurons_data_dentate_gyrus_granule_neurons_mdrg = all_neurons_data_dentate_gyrus_granule_neurons[all_neurons_data_dentate_gyrus_granule_neurons$location == 'mDRG',]
nrow(all_neurons_data_dentate_gyrus_granule_neurons_mdrg)
length(unique(all_neurons_data_dentate_gyrus_granule_neurons_mdrg$ligand))
length(unique(all_neurons_data_dentate_gyrus_granule_neurons_mdrg$receptor))
all_neurons_data_dentate_gyrus_granule_neurons_ra = all_neurons_data_dentate_gyrus_granule_neurons[all_neurons_data_dentate_gyrus_granule_neurons$location == 'RA sc',]
nrow(all_neurons_data_dentate_gyrus_granule_neurons_ra)
length(unique(all_neurons_data_dentate_gyrus_granule_neurons_ra$ligand))
length(unique(all_neurons_data_dentate_gyrus_granule_neurons_ra$receptor))
print('------------Di- and mesencephalon excitatory neurons--------------')
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons$receptor))
all_neurons_data_di_and_mesencephalon_excitatory_neurons_mdrg = all_neurons_data_di_and_mesencephalon_excitatory_neurons[all_neurons_data_di_and_mesencephalon_excitatory_neurons$location == 'mDRG',]
nrow(all_neurons_data_di_and_mesencephalon_excitatory_neurons_mdrg)
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons_mdrg$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons_mdrg$receptor))
all_neurons_data_di_and_mesencephalon_excitatory_neurons_ra = all_neurons_data_di_and_mesencephalon_excitatory_neurons[all_neurons_data_di_and_mesencephalon_excitatory_neurons$location == 'RA sc',]
nrow(all_neurons_data_di_and_mesencephalon_excitatory_neurons_ra)
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons_ra$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_excitatory_neurons_ra$receptor))
print('------------Di- and mesencephalon inhibitory neurons--------------')
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons$receptor))
all_neurons_data_di_and_mesencephalon_inhibitory_neurons_mdrg = all_neurons_data_di_and_mesencephalon_inhibitory_neurons[all_neurons_data_di_and_mesencephalon_inhibitory_neurons$location == 'mDRG',]
nrow(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_mdrg)
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_mdrg$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_mdrg$receptor))
all_neurons_data_di_and_mesencephalon_inhibitory_neurons_ra = all_neurons_data_di_and_mesencephalon_inhibitory_neurons[all_neurons_data_di_and_mesencephalon_inhibitory_neurons$location == 'RA sc',]
nrow(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_ra)
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_ra$ligand))
length(unique(all_neurons_data_di_and_mesencephalon_inhibitory_neurons_ra$receptor))
print('------------Enteric neurons--------------')
length(unique(all_neurons_data_enteric_neurons$ligand))
length(unique(all_neurons_data_enteric_neurons$receptor))
all_neurons_data_enteric_neurons_mdrg = all_neurons_data_enteric_neurons[all_neurons_data_enteric_neurons$location == 'mDRG',]
nrow(all_neurons_data_enteric_neurons_mdrg)
length(unique(all_neurons_data_enteric_neurons_mdrg$ligand))
length(unique(all_neurons_data_enteric_neurons_mdrg$receptor))
all_neurons_data_enteric_neurons_ra = all_neurons_data_enteric_neurons[all_neurons_data_enteric_neurons$location == 'RA sc',]
nrow(all_neurons_data_enteric_neurons_ra)
length(unique(all_neurons_data_enteric_neurons_ra$ligand))
length(unique(all_neurons_data_enteric_neurons_ra$receptor))

print('------------Hindbrain neurons--------------')
length(unique(all_neurons_data_hindbrain_neurons$ligand))
length(unique(all_neurons_data_hindbrain_neurons$receptor))
all_neurons_data_hindbrain_neurons_mdrg = all_neurons_data_hindbrain_neurons[all_neurons_data_hindbrain_neurons$location == 'mDRG',]
nrow(all_neurons_data_hindbrain_neurons_mdrg)
length(unique(all_neurons_data_hindbrain_neurons_mdrg$ligand))
length(unique(all_neurons_data_hindbrain_neurons_mdrg$receptor))
all_neurons_data_hindbrain_neurons_ra = all_neurons_data_hindbrain_neurons[all_neurons_data_hindbrain_neurons$location == 'RA sc',]
nrow(all_neurons_data_hindbrain_neurons_ra)
length(unique(all_neurons_data_hindbrain_neurons_ra$ligand))
length(unique(all_neurons_data_hindbrain_neurons_ra$receptor))

print('------------Olfactory inhibitory neurons--------------')
length(unique(all_neurons_data_olfactory_inhibitory_neurons$ligand))
length(unique(all_neurons_data_olfactory_inhibitory_neurons$receptor))
all_neurons_data_olfactory_inhibitory_neurons_mdrg = all_neurons_data_olfactory_inhibitory_neurons[all_neurons_data_olfactory_inhibitory_neurons$location == 'mDRG',]
nrow(all_neurons_data_olfactory_inhibitory_neurons_mdrg)
length(unique(all_neurons_data_olfactory_inhibitory_neurons_mdrg$ligand))
length(unique(all_neurons_data_olfactory_inhibitory_neurons_mdrg$receptor))
all_neurons_data_olfactory_inhibitory_neurons_ra = all_neurons_data_olfactory_inhibitory_neurons[all_neurons_data_olfactory_inhibitory_neurons$location == 'RA sc',]
nrow(all_neurons_data_olfactory_inhibitory_neurons_ra)
length(unique(all_neurons_data_olfactory_inhibitory_neurons_ra$ligand))
length(unique(all_neurons_data_olfactory_inhibitory_neurons_ra$receptor))

print('------------Peptidergic neurons--------------')
length(unique(all_neurons_data_peptidergic_neurons$ligand))
length(unique(all_neurons_data_peptidergic_neurons$receptor))
all_neurons_data_peptidergic_neurons_mdrg = all_neurons_data_peptidergic_neurons[all_neurons_data_peptidergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_peptidergic_neurons_mdrg)
length(unique(all_neurons_data_peptidergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_peptidergic_neurons_mdrg$receptor))
all_neurons_data_peptidergic_neurons_ra = all_neurons_data_peptidergic_neurons[all_neurons_data_peptidergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_peptidergic_neurons_ra)
length(unique(all_neurons_data_peptidergic_neurons_ra$ligand))
length(unique(all_neurons_data_peptidergic_neurons_ra$receptor))

print('------------Spinal cord inhibitory neurons--------------')
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons$ligand))
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons$receptor))
all_neurons_data_spinal_cord_inhibitory_neurons_mdrg = all_neurons_data_spinal_cord_inhibitory_neurons[all_neurons_data_spinal_cord_inhibitory_neurons$location == 'mDRG',]
nrow(all_neurons_data_spinal_cord_inhibitory_neurons_mdrg)
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons_mdrg$ligand))
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons_mdrg$receptor))
all_neurons_data_spinal_cord_inhibitory_neurons_ra = all_neurons_data_spinal_cord_inhibitory_neurons[all_neurons_data_spinal_cord_inhibitory_neurons$location == 'RA sc',]
nrow(all_neurons_data_spinal_cord_inhibitory_neurons_ra)
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons_ra$ligand))
length(unique(all_neurons_data_spinal_cord_inhibitory_neurons_ra$receptor))

print('------------Spinal cord excitatory neurons--------------')
length(unique(all_neurons_data_spinal_cord_excitatory_neurons$ligand))
length(unique(all_neurons_data_spinal_cord_excitatory_neurons$receptor))
all_neurons_data_spinal_cord_excitatory_neurons_mdrg = all_neurons_data_spinal_cord_excitatory_neurons[all_neurons_data_spinal_cord_excitatory_neurons$location == 'mDRG',]
nrow(all_neurons_data_spinal_cord_excitatory_neurons_mdrg)
length(unique(all_neurons_data_spinal_cord_excitatory_neurons_mdrg$ligand))
length(unique(all_neurons_data_spinal_cord_excitatory_neurons_mdrg$receptor))
all_neurons_data_spinal_cord_excitatory_neurons_ra = all_neurons_data_spinal_cord_excitatory_neurons[all_neurons_data_spinal_cord_excitatory_neurons$location == 'RA sc',]
nrow(all_neurons_data_spinal_cord_excitatory_neurons_ra)
length(unique(all_neurons_data_spinal_cord_excitatory_neurons_ra$ligand))
length(unique(all_neurons_data_spinal_cord_excitatory_neurons_ra$receptor))

print('------------Sympathetic cholinergic neurons--------------')
length(unique(all_neurons_data_sympathetic_cholinergic_neurons$ligand))
length(unique(all_neurons_data_sympathetic_cholinergic_neurons$receptor))
all_neurons_data_sympathetic_cholinergic_neurons_mdrg = all_neurons_data_sympathetic_cholinergic_neurons[all_neurons_data_sympathetic_cholinergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_sympathetic_cholinergic_neurons_mdrg)
length(unique(all_neurons_data_sympathetic_cholinergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_sympathetic_cholinergic_neurons_mdrg$receptor))
all_neurons_data_sympathetic_cholinergic_neurons_ra = all_neurons_data_sympathetic_cholinergic_neurons[all_neurons_data_sympathetic_cholinergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_sympathetic_cholinergic_neurons_ra)
length(unique(all_neurons_data_sympathetic_cholinergic_neurons_ra$ligand))
length(unique(all_neurons_data_sympathetic_cholinergic_neurons_ra$receptor))
print('------------Sympathetic noradrenergic neurons--------------')
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons$ligand))
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons$receptor))
all_neurons_data_sympathetic_nonadrenergic_neurons_mdrg = all_neurons_data_sympathetic_nonadrenergic_neurons[all_neurons_data_sympathetic_nonadrenergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_sympathetic_nonadrenergic_neurons_mdrg)
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons_mdrg$receptor))
all_neurons_data_sympathetic_nonadrenergic_neurons_ra = all_neurons_data_sympathetic_nonadrenergic_neurons[all_neurons_data_sympathetic_nonadrenergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_sympathetic_nonadrenergic_neurons_ra)
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons_ra$ligand))
length(unique(all_neurons_data_sympathetic_nonadrenergic_neurons_ra$receptor))

print('-------------Peripheral sensory neurofilament------------------')
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons$receptor))
all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg = all_neurons_data_peripheral_sensory_neurofilament_neurons[all_neurons_data_peripheral_sensory_neurofilament_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_neurofilament_neurons_ra = all_neurons_data_peripheral_sensory_neurofilament_neurons[all_neurons_data_peripheral_sensory_neurofilament_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra$receptor))

print('-------------Peripheral sensory non-peptidergic neurons------------------')
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$receptor))
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg = all_neurons_data_peripheral_sensory_nonpeptidergic_neurons[all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra = all_neurons_data_peripheral_sensory_nonpeptidergic_neurons[all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra$receptor))

print('-------------Peripheral sensory peptidergic neurons------------------')
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons$receptor))
all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg = all_neurons_data_peripheral_sensory_peptidergic_neurons[all_neurons_data_peripheral_sensory_peptidergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_peptidergic_neurons_ra = all_neurons_data_peripheral_sensory_peptidergic_neurons[all_neurons_data_peripheral_sensory_peptidergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra$receptor))
```


Below we specify by the three specific neuron cell types for all groups before splitting by fibroblast subtype.

```{r}
print('------------Peripheral sensory neurofilament neurons--------------')
specific_neuron_data_peripheral_sensory_neurofilament_neurons <- specific_neuron_data[(specific_neuron_data$ligand_type == 'Peripheral sensory neurofilament neurons') | (specific_neuron_data$receptor_type == 'Peripheral sensory neurofilament neurons'),]

print('------------Peripheral sensory non-peptidergic neurons--------------')
specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons <- specific_neuron_data[(specific_neuron_data$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (specific_neuron_data$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]

print('------------Peripheral sensory peptidergic neurons--------------')
specific_neuron_data_peripheral_sensory_peptidergic_neurons <- specific_neuron_data[(specific_neuron_data$ligand_type == 'Peripheral sensory peptidergic neurons') | (specific_neuron_data$receptor_type == 'Peripheral sensory peptidergic neurons'),]
```

Below we look at some statistics for the unique cell types.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------Peripheral sensory neurofilament------------------')
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons$ligand))
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons$receptor))
specific_neuron_data_peripheral_sensory_neurofilament_neurons_mdrg = specific_neuron_data_peripheral_sensory_neurofilament_neurons[specific_neuron_data_peripheral_sensory_neurofilament_neurons$location == 'mDRG',]
nrow(specific_neuron_data_peripheral_sensory_neurofilament_neurons_mdrg)
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons_mdrg$ligand))
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons_mdrg$receptor))
specific_neuron_data_peripheral_sensory_neurofilament_neurons_ra = specific_neuron_data_peripheral_sensory_neurofilament_neurons[specific_neuron_data_peripheral_sensory_neurofilament_neurons$location == 'RA sc',]
nrow(specific_neuron_data_peripheral_sensory_neurofilament_neurons_ra)
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons_ra$ligand))
length(unique(specific_neuron_data_peripheral_sensory_neurofilament_neurons_ra$receptor))

print('-------------Peripheral sensory non-peptidergic neurons------------------')
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons$ligand))
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons$receptor))
specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_mdrg = specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons[specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons$location == 'mDRG',]
nrow(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_mdrg)
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$ligand))
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$receptor))
specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_ra = specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons[specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons$location == 'RA sc',]
nrow(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_ra)
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_ra$ligand))
length(unique(specific_neuron_data_peripheral_sensory_nonpeptidergic_neurons_ra$receptor))

print('-------------Peripheral sensory peptidergic neurons------------------')
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons$ligand))
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons$receptor))
specific_neuron_data_peripheral_sensory_peptidergic_neurons_mdrg = specific_neuron_data_peripheral_sensory_peptidergic_neurons[specific_neuron_data_peripheral_sensory_peptidergic_neurons$location == 'mDRG',]
nrow(specific_neuron_data_peripheral_sensory_peptidergic_neurons_mdrg)
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons_mdrg$ligand))
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons_mdrg$receptor))
specific_neuron_data_peripheral_sensory_peptidergic_neurons_ra = specific_neuron_data_peripheral_sensory_peptidergic_neurons[specific_neuron_data_peripheral_sensory_peptidergic_neurons$location == 'RA sc',]
nrow(specific_neuron_data_peripheral_sensory_peptidergic_neurons_ra)
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons_ra$ligand))
length(unique(specific_neuron_data_peripheral_sensory_peptidergic_neurons_ra$receptor))
```

Below we specify by the three specific neuron cell types for all types before splitting by fibroblast subtype.

```{r}
print('------------Peripheral sensory neurofilament neurons--------------')
all_types_data_peripheral_sensory_neurofilament_neurons <- all_types_data[(all_types_data$ligand_type == 'Peripheral sensory neurofilament neurons') | (all_types_data$receptor_type == 'Peripheral sensory neurofilament neurons'),]

print('------------Peripheral sensory non-peptidergic neurons--------------')
all_types_data_peripheral_sensory_nonpeptidergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (all_types_data$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]

print('------------Peripheral sensory peptidergic neurons--------------')
all_types_data_peripheral_sensory_peptidergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Peripheral sensory peptidergic neurons') | (all_types_data$receptor_type == 'Peripheral sensory peptidergic neurons'),]

print('------------Cerebellum neurons--------------')
all_types_data_cerebellum_neurons <- all_types_data[(all_types_data$ligand_type == 'Cerebellum neurons') | (all_types_data$receptor_type == 'Cerebellum neurons'),]

print('------------Cholinergic and monoaminergic neurons--------------')
all_types_data_cholinergic_and_monoaminergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Cholinergic and monoaminergic neurons') | (all_types_data$receptor_type == 'Cholinergic and monoaminergic neurons'),]

print('------------Dentate gyrus granule neurons--------------')
all_types_data_dentate_gyrus_granule_neurons <- all_types_data[(all_types_data$ligand_type == 'Dentate gyrus granule neurons') | (all_types_data$receptor_type == 'Dentate gyrus granule neurons'),]

print('------------Di- and mesencephalon excitatory neurons--------------')
all_types_data_di_and_mesencephalon_excitatory_neurons <- all_types_data[(all_types_data$ligand_type == 'Di- and mesencephalon excitatory neurons') | (all_types_data$receptor_type == 'Di- and mesencephalon excitatory neurons'),]

print('------------Di- and mesencephalon inhibitory neurons--------------')
all_types_data_di_and_mesencephalon_inhibitory_neurons <- all_types_data[(all_types_data$ligand_type == 'Di- and mesencephalon inhibitory neurons') | (all_types_data$receptor_type == 'Di- and mesencephalon inhibitory neurons'),]

print('------------Enteric neurons--------------')
all_types_data_enteric_neurons <- all_types_data[(all_types_data$ligand_type == 'Enteric neurons') | (all_types_data$receptor_type == 'Enteric neurons'),]

print('------------Hindbrain neurons--------------')
all_types_data_hindbrain_neurons <- all_types_data[(all_types_data$ligand_type == 'Hindbrain neurons') | (all_types_data$receptor_type == 'Hindbrain neurons'),]

print('------------Olfactory inhibitory neurons--------------')
all_types_data_olfactory_inhibitory_neurons <- all_types_data[(all_types_data$ligand_type == 'Olfactory inhibitory neurons') | (all_types_data$receptor_type == 'Olfactory inhibitory neurons'),]

print('------------Peptidergic neurons--------------')
all_types_data_peptidergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Peptidergic neurons') | (all_types_data$receptor_type == 'Peptidergic neurons'),]

print('------------Spinal cord inhibitory neurons--------------')
all_types_data_spinal_cord_inhibitory_neurons <- all_types_data[(all_types_data$ligand_type == 'Spinal cord inhibitory neurons') | (all_types_data$receptor_type == 'Spinal cord inhibitory neurons'),]

print('------------Spinal cord excitatory neurons--------------')
all_types_data_spinal_cord_excitatory_neurons <- all_types_data[(all_types_data$ligand_type == 'Spinal cord excitatory neurons') | (all_types_data$receptor_type == 'Spinal cord excitatory neurons'),]

print('------------Sympathetic cholinergic neurons--------------')
all_types_data_sympathetic_cholinergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Sympathetic cholinergic neurons') | (all_types_data$receptor_type == 'Sympathetic cholinergic neurons'),]

print('------------Sympathetic noradrenergic neurons--------------')
all_types_data_sympathetic_nonadrenergic_neurons <- all_types_data[(all_types_data$ligand_type == 'Sympathetic noradrenergic neurons') | (all_types_data$receptor_type == 'Sympathetic noradrenergic neurons'),]
```

Below we look at some statistics for the unique cell types.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')

print('------------Cerebellum neurons--------------')
length(unique(all_types_data_cerebellum_neurons$ligand))
length(unique(all_types_data_cerebellum_neurons$receptor))
all_types_data_cerebellum_neurons_mdrg = all_types_data_cerebellum_neurons[all_types_data_cerebellum_neurons$location == 'mDRG',]
nrow(all_types_data_cerebellum_neurons_mdrg)
length(unique(all_types_data_cerebellum_neurons_mdrg$ligand))
length(unique(all_types_data_cerebellum_neurons_mdrg$receptor))
all_types_data_cerebellum_neurons_ra = all_types_data_cerebellum_neurons[all_types_data_cerebellum_neurons$location == 'RA sc',]
nrow(all_types_data_cerebellum_neurons_ra)
length(unique(all_types_data_cerebellum_neurons_ra$ligand))
length(unique(all_types_data_cerebellum_neurons_ra$receptor))
print('------------Cholinergic and monoaminergic neurons--------------')
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons$ligand))
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons$receptor))
all_types_data_cholinergic_and_monoaminergic_neurons_mdrg = all_types_data_cholinergic_and_monoaminergic_neurons[all_types_data_cholinergic_and_monoaminergic_neurons$location == 'mDRG',]
nrow(all_types_data_cholinergic_and_monoaminergic_neurons_mdrg)
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons_mdrg$ligand))
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons_mdrg$receptor))
all_types_data_cholinergic_and_monoaminergic_neurons_ra = all_types_data_cholinergic_and_monoaminergic_neurons[all_types_data_cholinergic_and_monoaminergic_neurons$location == 'RA sc',]
nrow(all_types_data_cholinergic_and_monoaminergic_neurons_ra)
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons_ra$ligand))
length(unique(all_types_data_cholinergic_and_monoaminergic_neurons_ra$receptor))
print('------------Dentate gyrus granule neurons--------------')
length(unique(all_types_data_dentate_gyrus_granule_neurons$ligand))
length(unique(all_types_data_dentate_gyrus_granule_neurons$receptor))
all_types_data_dentate_gyrus_granule_neurons_mdrg = all_types_data_dentate_gyrus_granule_neurons[all_types_data_dentate_gyrus_granule_neurons$location == 'mDRG',]
nrow(all_types_data_dentate_gyrus_granule_neurons_mdrg)
length(unique(all_types_data_dentate_gyrus_granule_neurons_mdrg$ligand))
length(unique(all_types_data_dentate_gyrus_granule_neurons_mdrg$receptor))
all_types_data_dentate_gyrus_granule_neurons_ra = all_types_data_dentate_gyrus_granule_neurons[all_types_data_dentate_gyrus_granule_neurons$location == 'RA sc',]
nrow(all_types_data_dentate_gyrus_granule_neurons_ra)
length(unique(all_types_data_dentate_gyrus_granule_neurons_ra$ligand))
length(unique(all_types_data_dentate_gyrus_granule_neurons_ra$receptor))
print('------------Di- and mesencephalon excitatory neurons--------------')
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons$ligand))
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons$receptor))
all_types_data_di_and_mesencephalon_excitatory_neurons_mdrg = all_types_data_di_and_mesencephalon_excitatory_neurons[all_types_data_di_and_mesencephalon_excitatory_neurons$location == 'mDRG',]
nrow(all_types_data_di_and_mesencephalon_excitatory_neurons_mdrg)
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons_mdrg$ligand))
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons_mdrg$receptor))
all_types_data_di_and_mesencephalon_excitatory_neurons_ra = all_types_data_di_and_mesencephalon_excitatory_neurons[all_types_data_di_and_mesencephalon_excitatory_neurons$location == 'RA sc',]
nrow(all_types_data_di_and_mesencephalon_excitatory_neurons_ra)
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons_ra$ligand))
length(unique(all_types_data_di_and_mesencephalon_excitatory_neurons_ra$receptor))
print('------------Di- and mesencephalon inhibitory neurons--------------')
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons$ligand))
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons$receptor))
all_types_data_di_and_mesencephalon_inhibitory_neurons_mdrg = all_types_data_di_and_mesencephalon_inhibitory_neurons[all_types_data_di_and_mesencephalon_inhibitory_neurons$location == 'mDRG',]
nrow(all_types_data_di_and_mesencephalon_inhibitory_neurons_mdrg)
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons_mdrg$ligand))
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons_mdrg$receptor))
all_types_data_di_and_mesencephalon_inhibitory_neurons_ra = all_types_data_di_and_mesencephalon_inhibitory_neurons[all_types_data_di_and_mesencephalon_inhibitory_neurons$location == 'RA sc',]
nrow(all_types_data_di_and_mesencephalon_inhibitory_neurons_ra)
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons_ra$ligand))
length(unique(all_types_data_di_and_mesencephalon_inhibitory_neurons_ra$receptor))
print('------------Enteric neurons--------------')
length(unique(all_types_data_enteric_neurons$ligand))
length(unique(all_types_data_enteric_neurons$receptor))
all_types_data_enteric_neurons_mdrg = all_types_data_enteric_neurons[all_types_data_enteric_neurons$location == 'mDRG',]
nrow(all_types_data_enteric_neurons_mdrg)
length(unique(all_types_data_enteric_neurons_mdrg$ligand))
length(unique(all_types_data_enteric_neurons_mdrg$receptor))
all_types_data_enteric_neurons_ra = all_types_data_enteric_neurons[all_types_data_enteric_neurons$location == 'RA sc',]
nrow(all_types_data_enteric_neurons_ra)
length(unique(all_types_data_enteric_neurons_ra$ligand))
length(unique(all_types_data_enteric_neurons_ra$receptor))

print('------------Hindbrain neurons--------------')
length(unique(all_types_data_hindbrain_neurons$ligand))
length(unique(all_types_data_hindbrain_neurons$receptor))
all_types_data_hindbrain_neurons_mdrg = all_types_data_hindbrain_neurons[all_types_data_hindbrain_neurons$location == 'mDRG',]
nrow(all_types_data_hindbrain_neurons_mdrg)
length(unique(all_types_data_hindbrain_neurons_mdrg$ligand))
length(unique(all_types_data_hindbrain_neurons_mdrg$receptor))
all_types_data_hindbrain_neurons_ra = all_types_data_hindbrain_neurons[all_types_data_hindbrain_neurons$location == 'RA sc',]
nrow(all_types_data_hindbrain_neurons_ra)
length(unique(all_types_data_hindbrain_neurons_ra$ligand))
length(unique(all_types_data_hindbrain_neurons_ra$receptor))

print('------------Olfactory inhibitory neurons--------------')
length(unique(all_types_data_olfactory_inhibitory_neurons$ligand))
length(unique(all_types_data_olfactory_inhibitory_neurons$receptor))
all_types_data_olfactory_inhibitory_neurons_mdrg = all_types_data_olfactory_inhibitory_neurons[all_types_data_olfactory_inhibitory_neurons$location == 'mDRG',]
nrow(all_types_data_olfactory_inhibitory_neurons_mdrg)
length(unique(all_types_data_olfactory_inhibitory_neurons_mdrg$ligand))
length(unique(all_types_data_olfactory_inhibitory_neurons_mdrg$receptor))
all_types_data_olfactory_inhibitory_neurons_ra = all_types_data_olfactory_inhibitory_neurons[all_types_data_olfactory_inhibitory_neurons$location == 'RA sc',]
nrow(all_types_data_olfactory_inhibitory_neurons_ra)
length(unique(all_types_data_olfactory_inhibitory_neurons_ra$ligand))
length(unique(all_types_data_olfactory_inhibitory_neurons_ra$receptor))

print('------------Peptidergic neurons--------------')
length(unique(all_types_data_peptidergic_neurons$ligand))
length(unique(all_types_data_peptidergic_neurons$receptor))
all_types_data_peptidergic_neurons_mdrg = all_types_data_peptidergic_neurons[all_types_data_peptidergic_neurons$location == 'mDRG',]
nrow(all_types_data_peptidergic_neurons_mdrg)
length(unique(all_types_data_peptidergic_neurons_mdrg$ligand))
length(unique(all_types_data_peptidergic_neurons_mdrg$receptor))
all_types_data_peptidergic_neurons_ra = all_types_data_peptidergic_neurons[all_types_data_peptidergic_neurons$location == 'RA sc',]
nrow(all_types_data_peptidergic_neurons_ra)
length(unique(all_types_data_peptidergic_neurons_ra$ligand))
length(unique(all_types_data_peptidergic_neurons_ra$receptor))

print('------------Spinal cord inhibitory neurons--------------')
length(unique(all_types_data_spinal_cord_inhibitory_neurons$ligand))
length(unique(all_types_data_spinal_cord_inhibitory_neurons$receptor))
all_types_data_spinal_cord_inhibitory_neurons_mdrg = all_types_data_spinal_cord_inhibitory_neurons[all_types_data_spinal_cord_inhibitory_neurons$location == 'mDRG',]
nrow(all_types_data_spinal_cord_inhibitory_neurons_mdrg)
length(unique(all_types_data_spinal_cord_inhibitory_neurons_mdrg$ligand))
length(unique(all_types_data_spinal_cord_inhibitory_neurons_mdrg$receptor))
all_types_data_spinal_cord_inhibitory_neurons_ra = all_types_data_spinal_cord_inhibitory_neurons[all_types_data_spinal_cord_inhibitory_neurons$location == 'RA sc',]
nrow(all_types_data_spinal_cord_inhibitory_neurons_ra)
length(unique(all_types_data_spinal_cord_inhibitory_neurons_ra$ligand))
length(unique(all_types_data_spinal_cord_inhibitory_neurons_ra$receptor))

print('------------Spinal cord excitatory neurons--------------')
length(unique(all_types_data_spinal_cord_excitatory_neurons$ligand))
length(unique(all_types_data_spinal_cord_excitatory_neurons$receptor))
all_types_data_spinal_cord_excitatory_neurons_mdrg = all_types_data_spinal_cord_excitatory_neurons[all_types_data_spinal_cord_excitatory_neurons$location == 'mDRG',]
nrow(all_types_data_spinal_cord_excitatory_neurons_mdrg)
length(unique(all_types_data_spinal_cord_excitatory_neurons_mdrg$ligand))
length(unique(all_types_data_spinal_cord_excitatory_neurons_mdrg$receptor))
all_types_data_spinal_cord_excitatory_neurons_ra = all_types_data_spinal_cord_excitatory_neurons[all_types_data_spinal_cord_excitatory_neurons$location == 'RA sc',]
nrow(all_types_data_spinal_cord_excitatory_neurons_ra)
length(unique(all_types_data_spinal_cord_excitatory_neurons_ra$ligand))
length(unique(all_types_data_spinal_cord_excitatory_neurons_ra$receptor))

print('------------Sympathetic cholinergic neurons--------------')
length(unique(all_types_data_sympathetic_cholinergic_neurons$ligand))
length(unique(all_types_data_sympathetic_cholinergic_neurons$receptor))
all_types_data_sympathetic_cholinergic_neurons_mdrg = all_types_data_sympathetic_cholinergic_neurons[all_types_data_sympathetic_cholinergic_neurons$location == 'mDRG',]
nrow(all_types_data_sympathetic_cholinergic_neurons_mdrg)
length(unique(all_types_data_sympathetic_cholinergic_neurons_mdrg$ligand))
length(unique(all_types_data_sympathetic_cholinergic_neurons_mdrg$receptor))
all_types_data_sympathetic_cholinergic_neurons_ra = all_types_data_sympathetic_cholinergic_neurons[all_types_data_sympathetic_cholinergic_neurons$location == 'RA sc',]
nrow(all_types_data_sympathetic_cholinergic_neurons_ra)
length(unique(all_types_data_sympathetic_cholinergic_neurons_ra$ligand))
length(unique(all_types_data_sympathetic_cholinergic_neurons_ra$receptor))
print('------------Sympathetic noradrenergic neurons--------------')
length(unique(all_types_data_sympathetic_nonadrenergic_neurons$ligand))
length(unique(all_types_data_sympathetic_nonadrenergic_neurons$receptor))
all_types_data_sympathetic_nonadrenergic_neurons_mdrg = all_types_data_sympathetic_nonadrenergic_neurons[all_types_data_sympathetic_nonadrenergic_neurons$location == 'mDRG',]
nrow(all_types_data_sympathetic_nonadrenergic_neurons_mdrg)
length(unique(all_types_data_sympathetic_nonadrenergic_neurons_mdrg$ligand))
length(unique(all_types_data_sympathetic_nonadrenergic_neurons_mdrg$receptor))
all_types_data_sympathetic_nonadrenergic_neurons_ra = all_types_data_sympathetic_nonadrenergic_neurons[all_types_data_sympathetic_nonadrenergic_neurons$location == 'RA sc',]
nrow(all_types_data_sympathetic_nonadrenergic_neurons_ra)
length(unique(all_types_data_sympathetic_nonadrenergic_neurons_ra$ligand))
length(unique(all_types_data_sympathetic_nonadrenergic_neurons_ra$receptor))

print('-------------Peripheral sensory neurofilament------------------')
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons$ligand))
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons$receptor))
all_types_data_peripheral_sensory_neurofilament_neurons_mdrg = all_types_data_peripheral_sensory_neurofilament_neurons[all_types_data_peripheral_sensory_neurofilament_neurons$location == 'mDRG',]
nrow(all_types_data_peripheral_sensory_neurofilament_neurons_mdrg)
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons_mdrg$ligand))
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons_mdrg$receptor))
all_types_data_peripheral_sensory_neurofilament_neurons_ra = all_types_data_peripheral_sensory_neurofilament_neurons[all_types_data_peripheral_sensory_neurofilament_neurons$location == 'RA sc',]
nrow(all_types_data_peripheral_sensory_neurofilament_neurons_ra)
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons_ra$ligand))
length(unique(all_types_data_peripheral_sensory_neurofilament_neurons_ra$receptor))

print('-------------Peripheral sensory non-peptidergic neurons------------------')
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons$ligand))
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons$receptor))
all_types_data_peripheral_sensory_nonpeptidergic_neurons_mdrg = all_types_data_peripheral_sensory_nonpeptidergic_neurons[all_types_data_peripheral_sensory_nonpeptidergic_neurons$location == 'mDRG',]
nrow(all_types_data_peripheral_sensory_nonpeptidergic_neurons_mdrg)
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$ligand))
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$receptor))
all_types_data_peripheral_sensory_nonpeptidergic_neurons_ra = all_types_data_peripheral_sensory_nonpeptidergic_neurons[all_types_data_peripheral_sensory_nonpeptidergic_neurons$location == 'RA sc',]
nrow(all_types_data_peripheral_sensory_nonpeptidergic_neurons_ra)
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons_ra$ligand))
length(unique(all_types_data_peripheral_sensory_nonpeptidergic_neurons_ra$receptor))

print('-------------Peripheral sensory peptidergic neurons------------------')
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons$ligand))
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons$receptor))
all_types_data_peripheral_sensory_peptidergic_neurons_mdrg = all_types_data_peripheral_sensory_peptidergic_neurons[all_types_data_peripheral_sensory_peptidergic_neurons$location == 'mDRG',]
nrow(all_types_data_peripheral_sensory_peptidergic_neurons_mdrg)
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons_mdrg$ligand))
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons_mdrg$receptor))
all_types_data_peripheral_sensory_peptidergic_neurons_ra = all_types_data_peripheral_sensory_peptidergic_neurons[all_types_data_peripheral_sensory_peptidergic_neurons$location == 'RA sc',]
nrow(all_types_data_peripheral_sensory_peptidergic_neurons_ra)
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons_ra$ligand))
length(unique(all_types_data_peripheral_sensory_peptidergic_neurons_ra$receptor))
```

Below we specify by the three specific neuron cell types for all neurons before splitting by fibroblast subtype.

```{r}
print('------------Peripheral sensory neurofilament neurons--------------')
all_neurons_data_peripheral_sensory_neurofilament_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory neurofilament neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory neurofilament neurons'),]

print('------------Peripheral sensory non-peptidergic neurons--------------')
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]

print('------------Peripheral sensory peptidergic neurons--------------')
all_neurons_data_peripheral_sensory_peptidergic_neurons <- all_neurons_data[(all_neurons_data$ligand_type == 'Peripheral sensory peptidergic neurons') | (all_neurons_data$receptor_type == 'Peripheral sensory peptidergic neurons'),]
```

Below we look at some statistics for the unique cell types.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------Peripheral sensory neurofilament------------------')
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons$receptor))
all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg = all_neurons_data_peripheral_sensory_neurofilament_neurons[all_neurons_data_peripheral_sensory_neurofilament_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_neurofilament_neurons_ra = all_neurons_data_peripheral_sensory_neurofilament_neurons[all_neurons_data_peripheral_sensory_neurofilament_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_neurofilament_neurons_ra$receptor))

print('-------------Peripheral sensory non-peptidergic neurons------------------')
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$receptor))
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg = all_neurons_data_peripheral_sensory_nonpeptidergic_neurons[all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra = all_neurons_data_peripheral_sensory_nonpeptidergic_neurons[all_neurons_data_peripheral_sensory_nonpeptidergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_nonpeptidergic_neurons_ra$receptor))

print('-------------Peripheral sensory peptidergic neurons------------------')
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons$receptor))
all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg = all_neurons_data_peripheral_sensory_peptidergic_neurons[all_neurons_data_peripheral_sensory_peptidergic_neurons$location == 'mDRG',]
nrow(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg)
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_mdrg$receptor))
all_neurons_data_peripheral_sensory_peptidergic_neurons_ra = all_neurons_data_peripheral_sensory_peptidergic_neurons[all_neurons_data_peripheral_sensory_peptidergic_neurons$location == 'RA sc',]
nrow(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra)
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra$ligand))
length(unique(all_neurons_data_peripheral_sensory_peptidergic_neurons_ra$receptor))
```


Below we specify by the three specific neuron cell types for all groups after splitting into fibroblast subtypes.

```{r}
print('------------Peripheral sensory neurofilament neurons--------------')
specific_neuron_data_f1_peripheral_sensory_neurofilament_neurons <- specific_neuron_data_f1[(specific_neuron_data_f1$ligand_type == 'Peripheral sensory neurofilament neurons') | (specific_neuron_data_f1$receptor_type == 'Peripheral sensory neurofilament neurons'),]
specific_neuron_data_f2_peripheral_sensory_neurofilament_neurons <- specific_neuron_data_f2[(specific_neuron_data_f2$ligand_type == 'Peripheral sensory neurofilament neurons') | (specific_neuron_data_f2$receptor_type == 'Peripheral sensory neurofilament neurons'),]
specific_neuron_data_f3_peripheral_sensory_neurofilament_neurons <- specific_neuron_data_f3[(specific_neuron_data_f3$ligand_type == 'Peripheral sensory neurofilament neurons') | (specific_neuron_data_f3$receptor_type == 'Peripheral sensory neurofilament neurons'),]
specific_neuron_data_f4_peripheral_sensory_neurofilament_neurons <- specific_neuron_data_f4[(specific_neuron_data_f4$ligand_type == 'Peripheral sensory neurofilament neurons') | (specific_neuron_data_f4$receptor_type == 'Peripheral sensory neurofilament neurons'),]


print('------------Peripheral sensory non-peptidergic neurons--------------')
specific_neuron_data_f1_peripheral_sensory_nonpeptidergic_neurons <- specific_neuron_data_f1[(specific_neuron_data_f1$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (specific_neuron_data_f1$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]
specific_neuron_data_f2_peripheral_sensory_nonpeptidergic_neurons <- specific_neuron_data_f2[(specific_neuron_data_f2$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (specific_neuron_data_f2$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]
specific_neuron_data_f3_peripheral_sensory_nonpeptidergic_neurons <- specific_neuron_data_f3[(specific_neuron_data_f3$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (specific_neuron_data_f3$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]
specific_neuron_data_f4_peripheral_sensory_nonpeptidergic_neurons <- specific_neuron_data_f4[(specific_neuron_data_f4$ligand_type == 'Peripheral sensory non-peptidergic neurons') | (specific_neuron_data_f4$receptor_type == 'Peripheral sensory non-peptidergic neurons'),]

print('------------Peripheral sensory peptidergic neurons--------------')
specific_neuron_data_f1_peripheral_sensory_peptidergic_neurons <- specific_neuron_data_f1[(specific_neuron_data_f1$ligand_type == 'Peripheral sensory peptidergic neurons') | (specific_neuron_data_f1$receptor_type == 'Peripheral sensory peptidergic neurons'),]
specific_neuron_data_f2_peripheral_sensory_peptidergic_neurons <- specific_neuron_data_f2[(specific_neuron_data_f2$ligand_type == 'Peripheral sensory peptidergic neurons') | (specific_neuron_data_f2$receptor_type == 'Peripheral sensory peptidergic neurons'),]
specific_neuron_data_f3_peripheral_sensory_peptidergic_neurons <- specific_neuron_data_f3[(specific_neuron_data_f3$ligand_type == 'Peripheral sensory peptidergic neurons') | (specific_neuron_data_f3$receptor_type == 'Peripheral sensory peptidergic neurons'),]
specific_neuron_data_f4_peripheral_sensory_peptidergic_neurons <- specific_neuron_data_f4[(specific_neuron_data_f4$ligand_type == 'Peripheral sensory peptidergic neurons') | (specific_neuron_data_f4$receptor_type == 'Peripheral sensory peptidergic neurons'),]
```

Below we get statistics for a multitude of things for peripheral sensory neurofilament neurons.

```{r}
print('Order: Total Unique Ligands')
print('Total Unique Receptors')
print('mDRG Ligand to Synovial Receptor Connections')
print('mDRG Ligands')
print('mDRG Receptors')
print('Synovial Ligand to mDRG Receptor Connections')
print('Synovial Ligands')
print('Synovial Receptors')
print('-------------SC-F1------------------')
length(unique(all_neuron_data_f1$ligand))
length(unique(all_neuron_data_f1$receptor))
all_neuron_data_f1_mdrg = all_neuron_data_f1[all_neuron_data_f1$location == 'mDRG',]
nrow(all_neuron_data_f1_mdrg)
length(unique(all_neuron_data_f1_mdrg$ligand))
length(unique(all_neuron_data_f1_mdrg$receptor))
all_neuron_data_f1_ra = all_neuron_data_f1[all_neuron_data_f1$location == 'RA sc',]
nrow(all_neuron_data_f1_ra)
length(unique(all_neuron_data_f1_ra$ligand))
length(unique(all_neuron_data_f1_ra$receptor))

print('-------------SC-F2------------------')
length(unique(all_neuron_data_f2$ligand))
length(unique(all_neuron_data_f2$receptor))
all_neuron_data_f2_mdrg = all_neuron_data_f2[all_neuron_data_f2$location == 'mDRG',]
nrow(all_neuron_data_f2_mdrg)
length(unique(all_neuron_data_f2_mdrg$ligand))
length(unique(all_neuron_data_f2_mdrg$receptor))
all_neuron_data_f2_ra = all_neuron_data_f2[all_neuron_data_f2$location == 'RA sc',]
nrow(all_neuron_data_f2_ra)
length(unique(all_neuron_data_f2_ra$ligand))
length(unique(all_neuron_data_f2_ra$receptor))

print('-------------SC-F3------------------')
length(unique(all_neuron_data_f3$ligand))
length(unique(all_neuron_data_f3$receptor))
all_neuron_data_f3_mdrg = all_neuron_data_f3[all_neuron_data_f3$location == 'mDRG',]
nrow(all_neuron_data_f3_mdrg)
length(unique(all_neuron_data_f3_mdrg$ligand))
length(unique(all_neuron_data_f3_mdrg$receptor))
all_neuron_data_f3_ra = all_neuron_data_f3[all_neuron_data_f3$location == 'RA sc',]
nrow(all_neuron_data_f3_ra)
length(unique(all_neuron_data_f3_ra$ligand))
length(unique(all_neuron_data_f3_ra$receptor))

print('-------------SC-F4------------------')
length(unique(all_neuron_data_f4$ligand))
length(unique(all_neuron_data_f4$receptor))
all_neuron_data_f4_mdrg = all_neuron_data_f4[all_neuron_data_f4$location == 'mDRG',]
nrow(all_neuron_data_f4_mdrg)
length(unique(all_neuron_data_f4_mdrg$ligand))
length(unique(all_neuron_data_f4_mdrg$receptor))
all_neuron_data_f4_ra = all_neuron_data_f4[all_neuron_data_f4$location == 'RA sc',]
nrow(all_neuron_data_f4_ra)
length(unique(all_neuron_data_f4_ra$ligand))
length(unique(all_neuron_data_f4_ra$receptor))
```

# Circos Plots

Below we create one plot with both mDRG to human RA and human RA to mDRG.

```{r, fig.height=10,fig.width=10}
library(BioCircos)

# Chromosomes on which the Receptor points should be displayed
points_chromosomes_ligand = c('Ligand', 'Ligand')
# Coordinates on which the Receptor points should be displayed (length.out = 11 because there are 11 unique genes in the receptor column
points_coordinates_ligand = seq(3, 101, length.out = 11)
# Values associated with each point, used as radial coordinate 
# We space them out according to the number of unique ligands
points_values_ligand = 1:length(points_coordinates_ligand)

# Size of the outside of the circle for ligands and receptors
# Since there are uniquely 11 ligands and 26 receptor genes, we make the slices of the circle 11/38*360 = 104 for the receptors and 360 - 104 for the ligands
myGenome = list("Ligand" = 104,
        "Receptor" = 256)

# Create circle for cell type identification to lie in
tracklist = BioCircosBackgroundTrack("myBackgroundTrack", minRadius = 0.88, maxRadius = 1.13,
  borderColors = "#AAAAAA", borderSize = 0.6, fillColors = "White") 

tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_ligand, points_coordinates_ligand, 
  points_values_ligand, colors = c("blue", "white", "white", "white", "blue", "white", "blue", "white", "white", "white", "white"), minRadius = 1.11, maxRadius = 1.11, shape = 'rect', size = 4)

tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_ligand, points_coordinates_ligand, 
  points_values_ligand, colors = c("black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white"), minRadius = 1.04, maxRadius = 1.04, shape = 'rect', size = 4)

tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_ligand, points_coordinates_ligand, 
  points_values_ligand, colors = c("orange", "orange", "orange", "white", "white", "white", "orange", "white", "white", "white", "white"), minRadius = 0.97, maxRadius = 0.97, shape = 'rect', size = 4)

tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_ligand, points_coordinates_ligand, 
  points_values_ligand, colors = c("red", "red", "red", "red", "red", "red", "red", "red", "red", "red", "red"), minRadius = 0.91, maxRadius = 0.91, shape = 'rect', size = 4)

# Chromosomes on which the ligand should be displayed
points_chromosomes_receptor = c('Receptor', 'Receptor')
# Coordinates on which the ligand should be displayed length.out = 26 
points_coordinates_receptor = seq(3, 253, length.out = 26)
# Values associated with each point, used as radial coordinate 
# We space them out according to the number of unique receptors
points_values_receptor = 1:length(points_chromosomes_receptor)

# Peripheral sensory peptidergic neurons:
tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_receptor, points_coordinates_receptor, 
  points_values_receptor, colors = c("white", "white", "white", "white", "white", "white", "white", "white", "magenta", "white", "white", "white", "white", "magenta", "magenta", "white", "magenta", "magenta", "white", "white", "white", "white", "white", "white", "magenta", "magenta"), minRadius = 0.90, maxRadius = 0.90)

# Peripheral sensory neurofilament neurons:
tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_receptor, points_coordinates_receptor, 
  points_values_receptor, colors = c("gold", "gold", "gold", "gold", "gold", "gold", "gold", "gold", "gold", "white", "white", "white", "white", "white", "white", "gold", "white", "gold", "gold", "gold", "white", "white", "white", "white", "white", "white"), minRadius = 1.00, maxRadius = 1.00)

# Peripheral sensory non-peptidergic neurons:
tracklist = tracklist + BioCircosSNPTrack('Gene Type', points_chromosomes_receptor, points_coordinates_receptor, 
  points_values_receptor, colors = c("white", "white", "white", "white", "white", "white", "white", "white", "white", "darkgray", "darkgray", "darkgray", "darkgray", "white", "white", "white", "white", "white", "white", "white", "darkgray", "darkgray", "darkgray", "darkgray", "white", "white"), minRadius = 1.10, maxRadius = 1.10)

#tracklist = tracklist + BioCircosTextTrack("testText", 'mDRG to Synovial Fibroblast', weight = "bold", size = '1em', x = -0.46, y = -1.25, displayGenomeBorder = TRUE)

links_chromosomes_1 = c('Ligand', 'Ligand', 'Ligand') # Chromosomes on which the links should start
links_chromosomes_2 = c('Receptor', 'Receptor', 'Receptor') # Chromosomes on which the links should end

# Coordinates to place start of links. The coordinates below correspond to the sequence given by seq(3, 101, length.out = 11) Their starting coordinate must be repeated for the number of connections between them and the number of ligands they are connected to.
links_pos_1 = c(3, 3, 3, 12.8, 3, 3, 3, 12.8, 12.8, 3, 3, 3, 12.8, 22.6, 52, 52, 12.8, 3, 3, 3, 12.8, 32.4, 22.6, 3, 3, 3, 12.8, 3, 22.6, 3, 12.8, 3, 22.6, 3, 12.8, 3, 42.2, 52, 42.2, 61.8, 71.6, 61.8, 71.6, 61.8, 52, 71.6, 81.4, 91.2, 52, 52, 101, 101, 52, 52, 61.8, 71.6, 101)
# Coordinates to place end of links. The coordinates below correspond to the sequence given by seq(3, 253, length.out = 26)
links_pos_2 = c(3, 13, 23, 33, 3, 13, 23, 43, 33, 3, 13, 23, 43, 53, 63, 73, 33, 3, 13, 23, 43, 83, 53, 93, 103, 93, 113, 103, 123, 93, 113, 103, 123, 93, 113, 103, 133, 73, 133, 143, 153, 143, 163, 143, 173, 153, 183, 193, 203, 213, 223, 233, 173, 243, 143, 163, 253)
# The labels are given at the end of the link. 
links_labels_12 = c("FGF1", "FGF11", "FGF9", "EDIL3", "", "", "", "LTBP3", "", "", "", "", "", "SHH", "CLSTN1", "CLSTN3", "", "", "", "", "", "NFASC", "", "FGF12", "NCAM1", "", "ITGB3BP", "", "DHH", "", "", "", "", "", "", "", "PTN", "", "", 'NTRK1', "EPHA10", "", "EPHA5", "", "NGFR", "", "UNC5A", "PLXNA1", "CAV1", "SLC45A3", "CD44", "CD82", "", "TNFRSF21", "", "", "CD9") 

tracklist = tracklist + BioCircosLinkTrack('myLinkTrack', links_chromosomes_1, links_pos_1,
  links_pos_1, links_chromosomes_2, links_pos_2, links_pos_2,
  maxRadius = 0.5, width = "0.1em", color = 'brown', labelSize = "0.90em", labels = links_labels_12)

links_chromosomes_3 = c('Receptor', 'Receptor', 'Receptor') # Chromosomes on which the links should start
links_chromosomes_4 = c('Ligand', 'Ligand', 'Ligand') # Chromosomes on which the links should end

# Now we start at the ligands
links_pos_3 = c(3, 13, 23, 33, 3, 13, 23, 43, 33, 3, 13, 23, 43, 53, 63, 73, 33, 3, 13, 23, 43, 83, 53, 93, 103, 93, 113, 103, 123, 93, 113, 103, 123, 93, 113, 103, 133, 73, 133, 143, 153, 143, 163, 143, 173, 153, 183, 193, 203, 213, 223, 233, 173, 243, 143, 163, 253)
# Now we end at the receptors
links_pos_4 = c(3, 3, 3, 12.8, 3, 3, 3, 12.8, 12.8, 3, 3, 3, 12.8, 22.6, 52, 52, 12.8, 3, 3, 3, 12.8, 32.4, 22.6, 3, 3, 3, 12.8, 3, 22.6, 3, 12.8, 3, 22.6, 3, 12.8, 3, 42.2, 52, 42.2, 61.8, 71.6, 61.8, 71.6, 61.8, 52, 71.6, 81.4, 91.2, 52, 52, 101, 101, 52, 52, 61.8, 71.6, 101)
# These links are for the receptors
links_labels_34 = c('FGFR1', "", "", "ITGB5", "", "", "", "", "", "", "", "", "", "CDON", "APP", "", "", "", "", "", "", "ANK3", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "PTPRS", "", "", "CTGF", "EFNA5", "", "", "", "", "", "NTN4", "SEMA6D", "", "", "HBEGF", "", "", "", "", "", "")

tracklist = tracklist + BioCircosLinkTrack('myLinkTrack', links_chromosomes_3, links_pos_3,
  links_pos_3, links_chromosomes_4, links_pos_4, links_pos_4,
  maxRadius = 0.5, width = "0.1em", color = 'brown', labelSize = "0.90em", labels = links_labels_34, labelPadding = 3)

links_chromosomes_5 = c('Receptor', 'Receptor', 'Receptor') # Chromosomes on which the links should start
links_chromosomes_6 = c('Ligand', 'Ligand', 'Ligand') # Chromosomes on which the links should end
links_pos_5 = c(143, 153, 143, 163, 143, 173, 153, 183, 193, 203, 213, 223, 233, 173, 243, 143, 163, 253)
links_pos_6 = c(61.8, 71.6, 61.8, 71.6, 61.8, 52, 71.6, 81.4, 91.2, 52, 52, 101, 101, 52, 52, 61.8, 71.6, 101)
links_labels_56 = c("", "", '', '', '', '', '', '', "", '', '', '', "", '', "", "", "", "")

tracklist = tracklist + BioCircosLinkTrack('myLinkTrack', links_chromosomes_5, links_pos_5,
  links_pos_5, links_chromosomes_6, links_pos_6, links_pos_6,
  maxRadius = 0.5, width = "0.1em", color = 'cornflowerblue', labelSize = "0.5em", labels = links_labels_56)

# Create inside arc for RA scRNA gene identification
arcs_chromosomes_ra = c('Ligand') # Chromosomes on which the arcs should be displayed
arcs_begin_ra = c(0)
arcs_end_ra = c(56)


links_pos_1 = c(3, 3, 3, 12.8, 3, 3, 3, 12.8, 12.8, 3, 3, 3, 12.8, 22.6, 52, 52, 12.8, 3, 3, 3, 12.8, 32.4, 22.6, 3, 3, 3, 12.8, 3, 22.6, 3, 12.8, 3, 22.6, 3, 12.8, 3, 42.2, 52, 42.2, 61.8, 71.6, 61.8, 71.6, 61.8, 52, 71.6, 81.4, 91.2, 52, 52, 101, 101, 52, 52, 61.8, 71.6, 101)
# Coordinates to place end of links. The coordinates below correspond to the sequence given by seq(3, 253, length.out = 26)
links_pos_2 = c(3, 13, 23, 33, 3, 13, 23, 43, 33, 3, 13, 23, 43, 53, 63, 73, 33, 3, 13, 23, 43, 83, 53, 93, 103, 93, 113, 103, 123, 93, 113, 103, 123, 93, 113, 103, 133, 73, 133, 143, 153, 143, 163, 143, 173, 153, 183, 193, 203, 213, 223, 233, 173, 243, 143, 163, 253)

# Make specific pain genes bold for RA
links_chromosomes_7 = c('Ligand', 'Ligand', 'Ligand') # Chromosomes on which the links should start
links_chromosomes_8 = c('Receptor', 'Receptor', 'Receptor') # Chromosomes on which the links should end
links_pos_7 = c(rep(3, 10), rep(3, 10), rep(3, 10), rep(12.8, 10), rep(12.8, 10), rep(22.6, 10), rep(52, 10), rep(52, 10), rep(32.4, 10), rep(3, 10), rep(3, 10), rep(12.8, 10), rep(22.6, 10), rep(42.2, 10), rep(61.8, 10), rep(71.6, 10), rep(71.6, 10), rep(52, 10), rep(81.4, 10), rep(91.2, 10), rep(52, 10), rep(52, 10), rep(101, 10), rep(101, 10), rep(52, 10), rep(101, 10))

links_pos_8 = c(rep(3, 10), rep(13, 10), rep(23, 10), rep(33, 10), rep(43, 10), rep(53, 10), rep(63, 10), rep(73, 10), rep(83, 10), rep(93, 10), rep(103, 10), rep(113, 10), rep(123, 10), rep(133, 10), rep(143, 10), rep(153, 10), rep(163, 10), rep(173, 10), rep(183, 10), rep(193, 10), rep(203, 10), rep(213, 10), rep(223, 10), rep(233, 10), rep(243, 10), rep(253, 10))
links_labels_78 = c(rep("FGF1", 10), rep("FGF11", 10), rep("FGF9", 10), rep("EDIL3", 10), rep("LTBP3", 10), rep("SHH", 10), rep("CLSTN1", 10), rep("CLSTN3", 10), rep("NFASC", 10), rep("FGF12", 10), rep("NCAM1", 10), rep("ITGB3BP", 10), rep("DHH", 10), rep("PTN", 10), rep("NTRK1", 10), rep("EPHA10", 10), rep("EPHA5", 10), rep("NGFR", 10), rep("UNC5A", 10), rep("PLXNA1", 10), rep("CAV1", 10), rep("SLC45A3", 10), rep("CD44", 10), rep("CD82", 10), rep("TNFRSF21", 10), rep("CD9", 10))

tracklist = tracklist + BioCircosLinkTrack('myLinkTrack', links_chromosomes_7, links_pos_7,
  links_pos_7, links_chromosomes_8, links_pos_8, links_pos_8,
  maxRadius = 0.5, width = "0em", color = 'brown', labelSize = "0.9em", labels = links_labels_78)

# Make specific pain genes bold for hDRG
links_chromosomes_9 = c('Receptor', 'Receptor', 'Receptor') # Chromosomes on which the links should start
links_chromosomes_10 = c('Ligand', 'Ligand', 'Ligand') # Chromosomes on which the links should end

links_pos_9 = c(rep(3, 10), rep(33, 10), rep(53, 10), rep(83, 10), rep(133, 10), rep(63, 10), rep(143, 10), rep(153, 10), rep(183, 10), rep(193, 10), rep(223, 10)) 
links_pos_10 = c(rep(3, 10), rep(12.8, 10), rep(22.6, 10), rep(32.4, 10), rep(42.2, 10), rep(52, 10), rep(61.8, 10), rep(71.6, 10), rep(81.4, 10), rep(91.2, 10), rep(101, 10))
links_labels_910 = c(rep("FGFR1", 10), rep("ITGB5", 10), rep("CDON", 10), rep("ANK3", 10), rep("PTPRS", 10), rep("APP", 10), rep("CTGF", 10), rep("EFNA5", 10), rep("NTN4", 10), rep("SEMA6D", 10), rep("HBEGF", 10))



tracklist = tracklist + BioCircosLinkTrack('myLinkTrack', links_chromosomes_9, links_pos_9,
  links_pos_9, links_chromosomes_10, links_pos_10, links_pos_10,
  maxRadius = 0.5, width = "0em", color = 'brown', labelSize = "0.9em", labels = links_labels_910)

#tracklist = tracklist + BioCircosArcTrack('myArcTrack', arcs_chromosomes_ra, arcs_begin_ra, arcs_end_ra, minRadius = 1.15, maxRadius = 1.20, colors = 'forestgreen')

# Create inside arc for RA scRNA gene identification
#arcs_chromosomes_ra2 = c('Ligand') # Chromosomes on which the arcs should be displayed
#arcs_begin_ra2 = c(50)
#arcs_end_ra2 = c(104)

#tracklist = tracklist + BioCircosArcTrack('myArcTrack', arcs_chromosomes_ra2, arcs_begin_ra2, arcs_end_ra2, minRadius = 1.20, maxRadius = 1.25, colors = 'deeppink3')

# Create inside arc for RA scRNA gene identification
#arcs_chromosomes_hdrg = c('Receptor') # Chromosomes on which the arcs should be displayed
#arcs_begin_hdrg = c(0)
#arcs_end_hdrg = c(136)

#tracklist = tracklist + BioCircosArcTrack('myArcTrack', arcs_chromosomes_hdrg, arcs_begin_hdrg, arcs_end_hdrg, minRadius = 1.20, maxRadius = 1.25, colors = 'deeppink3')

# Create inside arc for RA scRNA gene identification
arcs_chromosomes_hdrg2 = c('Receptor') # Chromosomes on which the arcs should be displayed
#arcs_begin_hdrg2 = c(136)
#arcs_end_hdrg2 = c(256)

#tracklist = tracklist + BioCircosArcTrack('myArcTrack', arcs_chromosomes_hdrg2, arcs_begin_hdrg2, arcs_end_hdrg2, minRadius = 1.15, maxRadius = 1.20, colors = 'forestgreen')

#tracklist = tracklist + BioCircosTextTrack('MytextTrack', 'Mouse DRG to Human RA - Specific Neurons', x = -0.6, y = -1.30, size = "1em",
#  weight = "bold", opacity = 1, color = "#000000")

#tracklist = tracklist + BioCircosTextTrack('MytextTrack', 'Receptor', x #= 0.75, y = -1, size = "1em",
##  weight = "bold", opacity = 1, color = "#000000")

#tracklist = tracklist + BioCircosTextTrack('MytextTrack', 'Ligand', x = #-0.95, y = -1, size = "1em",
#  weight = "bold", opacity = 1, color = "#000000")

#tracklist = tracklist + BioCircosArcTrack('myArcTrack', arcs_chromosomes, arcs_begin, arcs_end, minRadius = 0.85, maxRadius = 0.99, colors = 'forestgreen') 

BioCircos(tracklist, genome = myGenome, genomeFillColor = c('white', 'white'), chrPad = 0.05, displayGenomeBorder = FALSE, yChr =  FALSE,
  genomeTicksDisplay = FALSE,  genomeLabelTextSize = 0, genomeLabelDy = 0, width = 650, height = 650)
```

Below we make a legend for the fibroblast subtypes.

```{r}
svg("fibroblast_synovial_to_human.svg",width=10, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('CD34+ sublining fibroblasts (SC-F1) (3)', 'HLA-DRAhi sublining fibroblasts (SC-F2) (4)', 'DKK3+ sublining fibroblasts (SC-F3) (4)', 'CD55+ lining fibroblasts (SC-F4) (11)'), pch=15, pt.cex=3, cex=1.5, bty='n',
    col = c('blue', 'black', 'orange', 'red'))
mtext("Synovial Fibroblast Subtypes", at=0.24, cex=2)
```

Below we create plots for the number of connections for mDRG to RA and RA to mDRG.

```{r}
svg("C:/Wang Project/Ligand Receptor mouse DRG new data 8-28/mdrg_final_data_and_code/mdrg_interactome_connections.svg",width=8, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('Mouse Nervous System to Synovial Fibroblast (39 connections)', 'Synovial Fibroblast to Mouse Nervous System (18 connections)'), bty='n', lwd = 8, cex = 1.2, col = c('brown', 'cornflowerblue'), lty = c(1, 1, 1, 1), pch = c(NA, NA, NA, NA))
 #   col = c('brown', 'cyan'))
#mtext("mDRG Neuronal Cell Types", at=0.19, cex=1.1)
dev.off()
```

```{r}
svg("C:/Wang Project/Ligand Receptor mouse DRG new data 8-28/mdrg_final_data_and_code/fibroblast_synovial_to_mdrg.svg",width=10, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('CD34+ sublining fibroblasts (SC-F1) (1 Connection)', 'HLA-DRAhi sublining fibroblasts (SC-F2) (3 Connections)', 'DKK3+ sublining fibroblasts (SC-F3) (1 Connection)', 'CD55+ lining fibroblasts (SC-F4) (13 Connections)'), pch=15, pt.cex=3, cex=1.2, bty='n',
    col = c('blue', 'black', 'orange', 'red'))
mtext("Synovial Fibroblast Connections Synovial Fibroblast to Mouse Nervous System", at=0.34, cex=1.3)
```

```{r}
svg("C:/Wang Project/Ligand Receptor mouse DRG new data 8-28/mdrg_final_data_and_code/fibroblast_mdrg_to_synovial.svg",width=10, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('CD34+ sublining fibroblasts (SC-F1) (6 Connections)', 'HLA-DRAhi sublining fibroblasts (SC-F2) (8 Connections)', 'DKK3+ sublining fibroblasts (SC-F3) (10 Connections)', 'CD55+ lining fibroblasts (SC-F4) (15 Connections)'), pch=15, pt.cex=3, cex=1.2, bty='n',
    col = c('blue', 'black', 'orange', 'red'))
mtext("Synovial Fibroblast Connections Mouse Nervous System to Synovial Fibroblast", at=0.34, cex=1.3)
```

Below we create the connection legends for cell types.

```{r}
svg("C:/Wang Project/Ligand Receptor mouse DRG new data 8-28/mdrg_final_data_and_code/neuronal_mdrg_to_synovial.svg",width=10, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('Peripheral Sensory Non-peptidergic Neurons (23 Connections)', 'Peripheral Sensory Neurofilament Neurons (13 Connections)', 'Peripheral Sensory Peptidergic Neurons (3 Connections)'), pch=16, pt.cex=1, cex=0.95, bty='n',
    col = c('darkgrey', 'gold', 'magenta'))
mtext("Neuronal Cell Type Connections Mouse Nervous System to Synovial Fibroblast", at=0.4, cex=1.1)
```

```{r}
svg("C:/Wang Project/Ligand Receptor mouse DRG new data 8-28/mdrg_final_data_and_code/neuronal_synovial_to_mdrg.svg",width=10, height=3)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('Peripheral Sensory Non-peptidergic Neurons (4 Connections)', 'Peripheral Sensory Neurofilament Neurons (5 Connections)', 'Peripheral Sensory Peptidergic Neurons (9 Connections)'), pch=16, pt.cex=1, cex=0.95, bty='n',
    col = c('darkgrey', 'gold', 'magenta'))
mtext("Neuronal Cell Type Connections Synovial Fibroblast to Mouse Nervous System", at=0.4, cex=1.1)
```